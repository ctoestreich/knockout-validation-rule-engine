language: node_js
node_js:
  - 0.8
env:
  global:
    - GH_OWNER: ctoestreich
    - GH_PROJECT_NAME: knockout-validation-rule-engine
    - secure: NI1sD1BZcaD627T4oHeoxaxmom+rASSB+xYTOUnQfCCoWuQqfMHJvklhUJkkCZKx23/QrWo9Duy/tW1PvOGzXIvJ8G/TzX+AKYcp888CL7XLfukHCdASYime9W2r02OPLrf2fWtnwbuUb8MqZrksfheXOnOFqaYTPcfyBRfEibE=
before_script:
  - git config user.email "acetrike@yahoo.com"
  - git config user.name "Christian Oestreich"
  - npm install --quiet -g yo grunt-cli bower generator-travis-ci
  - bower install
script:
  - grunt --verbose
after_success:
  - git submodule add -b gh-pages https://$GH_TOKEN@github.com/${GH_OWNER}/${GH_PROJECT_NAME} site
  #> /dev/null 2>&1
  - cd site
#  - if git checkout gh-pages; then git checkout -b gh-pages; fi
  - git rm -rf .
  - cp -R ../dist/* .
  - cp ../dist/.* .
  - git add -f .
  - git commit -am "adding the yeoman build files to gh-pages"
  - git push https://${GH_TOKEN}@github.com/${GH_OWNER}/${GH_PROJECT_NAME} HEAD:gh-pages
  #> /dev/null 2>&1